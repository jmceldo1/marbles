<html>
<head>
  <link href="ControllerStyleSheet.css" rel="stylesheet" type="text/css">

  <script type="text/javascript"
          src="https://www.airconsole.com/api/airconsole-1.3.0.js"></script>
  <script type="text/javascript">
    var airconsole;
    var re = /images\/PNG-cards-1.3\/(.*)_of_/;
    var myTurn = false;
    /**
     * Sets up the communication to the screen.
     */
    function init() {
      airconsole = new AirConsole({"orientation": "portrait"});

      /*
       * Checks if this device is part of the active game.
       */
      airconsole.onActivePlayersChange = function(player) {
        var div = document.getElementById("player_id");
        if (player !== undefined) {
          div.innerHTML =  (["Player One", "Player Two", "Player Three", "Player Four"][player]);
          div.style.color = (["#3531ff", "#fe0000", "#fcff2f", "#009901"][player]);
        } else {
          div.innerHTML = "It's a 2 player game!!";
        }
      };

      /*
       * Makes the device vibrate if the screen says so.
       */
      airconsole.onMessage = function(from, data) {
        if (from == AirConsole.SCREEN && data.messageType !== undefined) {
          if (data.messageType === "Deal" && data.hand !== undefined) {
            for(i=0; i<data.hand.length; i++) {
              document.getElementById("p1c" + i).style.backgroundImage="url(images/PNG-cards-1.3/" + data.hand[i] + ".png)";
            }
            if (data.hand.length === 4) {
              document.getElementById("p1c4").style.backgroundImage="none";
            }
          } else if (data.messageType === "Clear") {
            var cardElements = document.getElementsByClassName("cards");
            var i; j = cardElements.length;
            for (var i = 0; i < j; i++) {
              cardElements[i].style.backgroundImage="url(images/PNG-cards-1.3/haas.jpg)";
           }
         } else if (data.messageType === "YourTurn") {
           myTurn = true;
         }
        }
      };
    }

    /**
     * Tells the screen to deal the paddle of this player.
     * @param amount
     */
    function deal() {
      airconsole.message(AirConsole.SCREEN, {messageType: "Deal"})
    }

    // ************************
    //  Move Logic
    // ************************
    function makeMove(cardValue, element) {
      if (cardValue !== undefined) {
        switch (cardValue) {
          case "2":
            //Move piece forward 2 spaces
            break;
          case "3":
            //Move piece forward 3 spaces
            break;
          case "4":
            //Move piece backwards 4 spaces
            break;
          case "5":
            //Move piece forward 5 spaces
            break;
          case "6":
            //Move piece forward 6 spaces
            break;
          case "7":
            //Move 2 pieces a total of 7 sapces
            break;
          case "8":
            //Move piece forward 8 spaces
            break;
          case "9":
            //Move piece forward 9 spaces
            break;
          case "10":
            //Move piece forward 10 spaces
            break;
          case "jack":
            //Swap the position of any two pieces
            break;
          case "queen":
            //Move piece forward 12 spaces
            break;
          case "king":
            // Move a piece out of Start
            break;
          case "ace":
            //Move a piece out of Start or 1 space
            break;
          default:

        }

        myTurn = false;
        airconsole.message(AirConsole.SCREEN, {messageType:"Move", cValue: cardValue});
        var cs = document.getElementById("centerSquare");
        cs.style.backgroundImage = element.style.backgroundImage;
        element.style.backgroundImage = "none";
        // Select marble and make move
        return true;
      }
      return false;
    }

    // ************************
    //  Card Listners
    // ************************

    function card0Listener() {
      if (myTurn) {
        let element = document.getElementById("p1c0");
        var cardValue = getCardValueFromElement(element);
        makeMove(cardValue, element);
      }
    }

    function card1Listener() {
      if (myTurn){
        let element = document.getElementById("p1c1");
        var cardValue = getCardValueFromElement(element);
        makeMove(cardValue, element);
      }
    }

    function card2Listener() {
      if (muTurn) {
        let element = document.getElementById("p1c2");
        var cardValue = getCardValueFromElement(element);
        makeMove(cardValue, element);
      }
    }

    function card3Listener() {
      if (myTurn) {
        let element = document.getElementById("p1c3");
        var cardValue = getCardValueFromElement(element);
        makeMove(cardValue, element);
      }
    }

    function card4Listener() {
      if (myTurn) {
        let element = document.getElementById("p1c4");
        var cardValue = getCardValueFromElement(element);
        makeMove(cardValue, element);
      }
    }

      function getCardValueFromElement(element) {
        var backGroundImageUrl = element.style.backgroundImage;
        if (backGroundImageUrl !== undefined) {
          var cardValueMatcher = backGroundImageUrl.match(re);
          if (cardValueMatcher !== undefined && cardValueMatcher !== null) {
            element.style.backgroundImage = "none";
            return cardValueMatcher[1];
          }
        }
      }

  </script>
</head>
<body onload="init()">
<div style="height: 1%"></div>
<div id="player_id">It's a 2 player game (Its Your Turn)</div>
<table class="tg">
  <tr>
    <td class="tg-0pky" colspan="5"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky" colspan="5"></th>
  </tr>
  <tr>
    <td class="tg-0pky"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-0pky"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-kwiq"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
  </tr>
  <tr>
    <td class="tg-0pky" colspan="5"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky" colspan="5"></td>
  </tr>
  <tr>
    <td class="tg-0pky"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-0pky"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
  </tr>
  <tr>
    <td class="tg-0pky" colspan="5"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-agym"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky" colspan="5"></td>
  </tr>
  <tr>
    <td class="tg-tw5s"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
  </tr>
  <tr>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-center" colspan="3" rowspan="3"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
  </tr>
  <tr>
    <td class="tg-6gc2"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-tw5s"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-706m"></td>
    <td class="tg-706m"></td>
    <td class="tg-706m"></td>
    <td class="tg-706m"></td>
    <td class="tg-6gc2"></td>
  </tr>
  <tr>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
  </tr>
  <tr>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-706m"></td>
  </tr>
  <tr>
    <td class="tg-0pky" colspan="5"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky" colspan="5"></td>
  </tr>
  <tr>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-706m"></td>
    <td class="tg-0pky"></td>
    <td class="tg-706m"></td>
    <td class="tg-0pky"></td>
  </tr>
  <tr>
    <td class="tg-0pky" colspan="5"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky" colspan="5"></td>
  </tr>
  <tr>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-2n01"></td>
    <td class="tg-0pky"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky"></td>
    <td class="tg-706m"></td>
    <td class="tg-0pky"></td>
    <td class="tg-706m"></td>
    <td class="tg-0pky"></td>
  </tr>
  <tr>
    <td class="tg-0pky" colspan="5"></td>
    <td class="tg-2n01"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-6gc2"></td>
    <td class="tg-0pky" colspan="5"></td>
  </tr>
</table>
<div class=button ontouchstart="deal()">
  <div class="button_label">Deal</div>
</div>
<div style="height: 1%"></div>
<button id="p1c0" ontouchstart="card0Listener()" alt="No Card" class="cards" style="width:16%;height:20%;display:inline-block;background-image: url(images/PNG-cards-1.3/haas.jpg);background-size:100% 100%;"></button>
<button id="p1c1" ontouchstart="card1Listener()" alt="No Card" class="cards" style="width:16%;height:20%;display:inline-block;background-image: url(images/PNG-cards-1.3/haas.jpg);background-size:100% 100%;"></div>
<button id="p1c2" ontouchstart="card2Listener()" alt="No Card" class="cards" style="width:16%;height:20%;display:inline-block;background-image: url(images/PNG-cards-1.3/haas.jpg);background-size:100% 100%;"></div>
<button id="p1c3" ontouchstart="card3Listener()" alt="No Card" class="cards" style="width:16%;height:20%;display:inline-block;background-image: url(images/PNG-cards-1.3/haas.jpg);background-size:100% 100%;"></div>
<button id="p1c4" ontouchstart="card4Listener()" alt="No Card" class="cards" style="width:16%;height:20%;display:inline-block;background-image: url(images/PNG-cards-1.3/haas.jpg);background-size:100% 100%;"></div>
</body>
</html>
